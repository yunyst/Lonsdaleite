{"version":3,"sources":[null,"webpack:///E:/WechatProgram/Lonsdaleite/components/AllProduct/AllProduct.vue?2be1","webpack:///E:/WechatProgram/Lonsdaleite/components/AllProduct/AllProduct.vue?d3e4","webpack:///E:/WechatProgram/Lonsdaleite/components/AllProduct/AllProduct.vue?27e5","uni-app:///components/AllProduct/AllProduct.vue","webpack:///E:/WechatProgram/Lonsdaleite/components/AllProduct/AllProduct.vue?4099","webpack:///E:/WechatProgram/Lonsdaleite/components/AllProduct/AllProduct.vue?5aab"],"names":["name","components","AllGoodsCard","computed","activeCategory","data","allGoods","columns","skip","limit","loading","hasMore","scrollTimer","watch","handler","immediate","methods","goProductDetail","console","uni","url","resetList","distributeGoods","goods","handleScrollToLower","clearTimeout","loadMoreGoods","uniCloud","pageType","res","newProducts","title","icon","mounted"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmI;AACnI;AAC8D;AACL;AACqC;;;AAG9F;AACsL;AACtL,gBAAgB,gMAAU;AAC1B,EAAE,gFAAM;AACR,EAAE,iGAAM;AACR,EAAE,0GAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,qGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,gNAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACjCA;AAAA;AAAA;AAAA;AAAssB,CAAgB,mtBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;ACgC1tB;AAEA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA,eAEA;EACAA;EACAC;IACAC;EACA;EACAC,4BACA;IACAC;MAAA;IAAA;EACA,GACA;EACAC;IACA;MACA;MACAC;MACAC,UACA,IACA,GACA;MAAA;MACA;MACAC;MACAC;MACAC;MAAA;MACAC;MACAC;IACA;EACA;EACAC;IACAP;MACAQ;QACA;MACA;MACAC;IACA;IACAX;MACA;MACA;IACA;EACA;EACAY;IACA;IACAC;MACAC;MACAC;QACAC;MACA;IACA;IACA;IACAC;MACA;MACA,gBACA,IACA,GACA;MACA;MACA;IACA;IACA;IACAC;MAAA;MACA,gBACA,IACA,GACA;MACAC;QACA;MACA;IACA;IAAA;IACAC;MAAA;MACA;;MAEA;MACAC;MACA;QACA;MACA;IACA;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,MACA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBACA;gBACA;gBAAA;gBAAA;gBAAA,OAGAC;kBACA3B;kBACAK;oBACAuB;oBACApB;oBACAC;kBACA;gBACA;cAAA;gBAPAoB;gBASAC;gBACA;gBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAZ;gBACAC;kBACAY;kBACAC;gBACA;cAAA;gBAAA;gBAEA;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;EAEA;EACAC;IAAA;IACA;MACAf;IACA;MACAA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACvJA;AAAA;AAAA;AAAA;AAAuhC,CAAgB,sgCAAG,EAAC,C;;;;;;;;;;;ACA3iC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/AllProduct/AllProduct.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./AllProduct.vue?vue&type=template&id=3e8fe9f8&scoped=true&\"\nvar renderjs\nimport script from \"./AllProduct.vue?vue&type=script&lang=js&\"\nexport * from \"./AllProduct.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AllProduct.vue?vue&type=style&index=0&id=3e8fe9f8&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3e8fe9f8\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/AllProduct/AllProduct.vue\"\nexport default component.exports","export * from \"-!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./AllProduct.vue?vue&type=template&id=3e8fe9f8&scoped=true&\"","var components\ntry {\n  components = {\n    AllGoodsCard: function () {\n      return import(\n        /* webpackChunkName: \"components/AllGoodsCard/AllGoodsCard\" */ \"@/components/AllGoodsCard/AllGoodsCard.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./AllProduct.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./AllProduct.vue?vue&type=script&lang=js&\"","<template>\r\n  <view>\r\n    <view class=\"product-grid\">\r\n      <view class=\"all-goods-title\">全部商品</view>\r\n      <!-- grid -->\r\n      <!-- <view class=\"goods-grid\">\r\n        <view class=\"goods-card\" v-for=\"good in allGoods\" :key=\"good.id\">\r\n          <AllGoodsCard :good=\"good\" @goProductDetail=\"goProductDetail\"></AllGoodsCard>\r\n        </view>\r\n      </view> -->\r\n\r\n      <!-- 瀑布流容器 -->\r\n      <scroll-view scroll-y class=\"goods-scroll\" @scrolltolower=\"handleScrollToLower\" :scroll-with-animation=\"true\">\r\n        <view class=\"goods-grid\">\r\n          <view class=\"goods-column\" v-for=\"(column, cIndex) in columns\" :key=\"cIndex\">\r\n            <view class=\"goods-card\" v-for=\"good in column\" :key=\"good.id\">\r\n              <AllGoodsCard :good=\"good\" @goProductDetail=\"goProductDetail\" />\r\n            </view>\r\n          </view>\r\n        </view>\r\n\r\n        <!-- 底部加载状态提示 -->\r\n        <view class=\"loading-footer\" style=\"font-size: 20rpx; display: flex; justify-content: center;\">\r\n          <text v-if=\"loading\">加载中...</text>\r\n          <text v-else-if=\"!hasMore\">没有更多了</text>\r\n        </view>\r\n      </scroll-view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\n  import {\r\n    mapState\r\n  } from 'vuex';\r\n  import AllGoodsCard from '../../components/AllGoodsCard/AllGoodsCard';\r\n  export default {\r\n    name: \"AllProduct\",\r\n    components: {\r\n      AllGoodsCard\r\n    },\r\n    computed: {\r\n      ...mapState({\r\n        activeCategory: state => state.home.activeCategory\r\n      })\r\n    },\r\n    data() {\r\n      return {\r\n        // 全部商品（下拉加载或上拉加载）\r\n        allGoods: [],\r\n        columns: [\r\n          [],\r\n          []\r\n        ], // 2列\r\n        //loadmore\r\n        skip: 0,\r\n        limit: 20,\r\n        loading: false, //goods loading\r\n        hasMore: true,\r\n        scrollTimer: null\r\n      };\r\n    },\r\n    watch: {\r\n      allGoods: {\r\n        handler(newGoods) {\r\n          this.distributeGoods(newGoods);\r\n        },\r\n        immediate: true\r\n      },\r\n      activeCategory() {\r\n        this.resetList();\r\n        this.loadMoreGoods();\r\n      }\r\n    },\r\n    methods: {\r\n      // 前往商品详情\r\n      goProductDetail(product) {\r\n        console.log(\"子组件传递过来的值：\", product);\r\n        uni.navigateTo({\r\n          url: `/pages/productDetail/productDetail?productId=${product.product_id}`\r\n        })\r\n      },\r\n      // 重置列表数据\r\n      resetList() {\r\n        this.allGoods = [];\r\n        this.columns = [\r\n          [],\r\n          []\r\n        ];\r\n        this.skip = 0;\r\n        this.hasMore = true;\r\n      },\r\n      //实现瀑布流\r\n      distributeGoods(goods) {\r\n        this.columns = [\r\n          [],\r\n          []\r\n        ]; // 清空列\r\n        goods.forEach((item, index) => {\r\n          this.columns[index % 2].push(item); // 交替分配到两列\r\n        })\r\n      }, // 滚动到底部触发\r\n      handleScrollToLower() {\r\n        if (this.loading || !this.hasMore) return;\r\n\r\n        // 防抖处理\r\n        clearTimeout(this.scrollTimer);\r\n        this.scrollTimer = setTimeout(() => {\r\n          this.loadMoreGoods();\r\n        }, 300);\r\n      },\r\n      //获取商品卡片详情 调用云函数请求全部商品信息\r\n      async loadMoreGoods() {\r\n        if (this.loading || !this.hasMore) return;\r\n        this.loading = true;\r\n        // this.loadMoreStatus = \"loading\";\r\n\r\n        try {\r\n          const res = await uniCloud.callFunction({\r\n            name: 'getProductCardInfo',\r\n            data: {\r\n              pageType: this.activeCategory,\r\n              skip: this.skip,\r\n              limit: this.limit\r\n            }\r\n          });\r\n\r\n          const newProducts = res.result.data || [];\r\n          this.allGoods = [...this.allGoods, ...newProducts];\r\n          this.skip += newProducts.length;\r\n          this.hasMore = newProducts.length >= this.limit;\r\n\r\n        } catch (err) {\r\n          console.error('加载更多失败:', err);\r\n          uni.showToast({\r\n            title: '加载失败',\r\n            icon: 'none'\r\n          });\r\n        } finally {\r\n          this.loading = false;\r\n        }\r\n      }\r\n\r\n    },\r\n    mounted() {\r\n      this.loadMoreGoods().then(() => {\r\n        console.log(\"allGoods 数据加载完成\", this.allGoods)\r\n      }).catch(() => {\r\n        console.log(\"失败\")\r\n      })\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n  /* 全部商品 */\r\n  .all-goods-wrap {\r\n    background-color: #fff;\r\n    margin-bottom: 20rpx;\r\n    padding-bottom: 20rpx;\r\n  }\r\n\r\n  .all-goods-title {\r\n    font-size: 32rpx;\r\n    font-weight: bold;\r\n    padding: 20rpx;\r\n    color: #333;\r\n  }\r\n\r\n  /* .goods-grid {\r\n    display: grid;\r\n    grid-template-columns: repeat(2, 1fr);\r\n  }\r\n\r\n  .goods-card {\r\n    width: 100%;\r\n  } */\r\n  .product-grid {\r\n    padding: 20rpx;\r\n  }\r\n\r\n  .goods-scroll {\r\n    height: calc(100vh - 120rpx);\r\n    /* 根据实际布局调整 */\r\n  }\r\n\r\n  .goods-grid {\r\n    display: flex;\r\n    justify-content: space-between;\r\n  }\r\n\r\n  .goods-column {\r\n    width: 48%;\r\n  }\r\n\r\n  .goods-card {\r\n    margin-bottom: 20rpx;\r\n  }\r\n</style>","import mod from \"-!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./AllProduct.vue?vue&type=style&index=0&id=3e8fe9f8&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./AllProduct.vue?vue&type=style&index=0&id=3e8fe9f8&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1745230057999\n      var cssReload = require(\"E:/App/HBuilderX.4.45/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}